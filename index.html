<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bad Apple Neon Hologram Player</title>
    <style>
        /* ğŸŒŸ ê¸°ë³¸ ìƒíƒœ: í™€ë¡œê·¸ë¨ ë„¤ì˜¨ ëª¨ë“œ ğŸŒŸ */
        body {
            background-color: #020205; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            -webkit-font-smoothing: none; 
            color: #d4ffff;
            font-family: sans-serif;
            user-select: none; 
            transition: all 0.3s ease; /* í…Œë§ˆê°€ ë°”ë€” ë•Œ ë¶€ë“œëŸ½ê²Œ ì „í™˜ë˜ë„ë¡ í•©ë‹ˆë‹¤ */
        }

        #ascii-screen {
            font-family: 'Courier New', Courier, monospace;
            font-size: 8px; 
            line-height: 8px; 
            letter-spacing: 1px; 
            white-space: pre; 
            margin-bottom: 20px;
            text-shadow: 0 0 2px #fff, 0 0 5px #00ffff, 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 40px #0077ff;
            transition: all 0.3s ease;
        }

        #controls-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background-color: rgba(0, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #00ffff;
            box-shadow: 0 0 10px #00ffff;
            transition: all 0.3s ease;
        }

        button {
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            background-color: #00ffff;
            color: black;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            box-shadow: 0 0 10px #00ffff;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: white;
            box-shadow: 0 0 20px #ffffff;
        }

        button:disabled {
            background-color: #555;
            box-shadow: none;
            cursor: not-allowed;
            color: #888;
        }

        .ascii-slider {
            font-family: 'Courier New', Courier, monospace;
            font-size: 16px;
            cursor: pointer;
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .ascii-slider:hover {
            color: #ffffff;
            text-shadow: 0 0 10px #ffffff;
        }

        #time-display {
            font-size: 14px;
            font-family: 'Courier New', Courier, monospace;
            text-shadow: 0 0 5px #00ffff;
            width: 90px;
            text-align: center;
            transition: all 0.3s ease;
        }

        #loading {
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
            margin-bottom: 10px;
        }

        /* ğŸŒŸ í´ë˜ì‹ ëª¨ë“œ ìƒíƒœ (ë„¤ì˜¨ ë„ê¸°) ğŸŒŸ */
        /* bodyì— classic-mode ë¼ëŠ” ì´ë¦„í‘œê°€ ë¶™ìœ¼ë©´ ì•„ë˜ ë””ìì¸ìœ¼ë¡œ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤ */
        body.classic-mode {
            background-color: black;
            color: white;
        }

        body.classic-mode #ascii-screen {
            color: white;
            text-shadow: none; /* ê·¸ë¦¼ì(ë¹›) ì™„ì „íˆ ì œê±° */
        }

        body.classic-mode #controls-container {
            background-color: transparent;
            border: 1px solid white;
            box-shadow: none;
        }

        body.classic-mode button {
            background-color: white;
            color: black;
            box-shadow: none;
        }

        body.classic-mode button:hover {
            background-color: #cccccc;
        }

        body.classic-mode .ascii-slider,
        body.classic-mode #time-display,
        body.classic-mode #loading {
            color: white;
            text-shadow: none;
        }
        
        body.classic-mode .ascii-slider:hover {
            color: #aaaaaa;
        }
    </style>
</head>
<body>

    <div id="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
    <div id="ascii-screen"></div>

    <div id="controls-container">
        <button id="play-btn" disabled>â–¶ PLAY</button>
        
        <span id="ascii-progress" class="ascii-slider">[------------------------------]</span>
        <span id="time-display">0:00 / 0:00</span>
        
        <span>VOL</span>
        <span id="ascii-volume" class="ascii-slider">[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]</span>

        <button id="neon-btn">NEON: ON</button>
    </div>

    <script>
        const screen = document.getElementById('ascii-screen');
        const playBtn = document.getElementById('play-btn');
        const neonBtn = document.getElementById('neon-btn'); // ìŠ¤ìœ„ì¹˜ ë²„íŠ¼ ê°€ì ¸ì˜¤ê¸°
        const loadingText = document.getElementById('loading');
        
        const asciiProgress = document.getElementById('ascii-progress');
        const asciiVolume = document.getElementById('ascii-volume');
        const timeDisplay = document.getElementById('time-display');
        
        const audio = new Audio('bad_apple.mp3'); 
        
        let frames = [];
        let isPlaying = false;
        let isNeon = true; // í˜„ì¬ ë„¤ì˜¨ ëª¨ë“œì¸ì§€ ê¸°ì–µí•˜ëŠ” ë³€ìˆ˜
        let intervalId;
        const fps = 15;

        const progressLen = 30; 
        const volumeLen = 10;   

        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            const min = Math.floor(seconds / 60);
            const sec = Math.floor(seconds % 60);
            return `${min}:${sec.toString().padStart(2, '0')}`;
        }

        function generateAsciiBar(percent, length, type) {
            const filledCount = Math.round(percent * length);
            const emptyCount = length - filledCount;
            
            if (type === 'progress') {
                if (filledCount === 0) return '[' + '-'.repeat(length) + ']';
                if (filledCount === length) return '[' + '='.repeat(length) + ']';
                return '[' + '='.repeat(filledCount - 1) + '>' + '-'.repeat(emptyCount) + ']';
            } else {
                const fullChar = 'â–ˆ';
                const emptyChar = 'â–‘';
                return '[' + fullChar.repeat(filledCount) + emptyChar.repeat(emptyCount) + ']';
            }
        }

        fetch('bad_apple_data.json')
            .then(response => response.json())
            .then(data => {
                frames = data;
                loadingText.style.display = 'none';
                screen.textContent = ">>> SYSTEM READY <<<\nPRESS START BUTTON";
                playBtn.disabled = false;
            })
            .catch(error => console.error("Error loading JSON:", error));

        function renderFrame() {
            let currentFrame = Math.floor(audio.currentTime * fps);
            if (currentFrame < frames.length) {
                screen.textContent = frames[currentFrame];
            } else {
                stopPlaying();
            }
        }

        function startPlaying() {
            isPlaying = true;
            playBtn.textContent = 'â¸ PAUSE';
            audio.play();
            intervalId = setInterval(renderFrame, 1000 / fps);
        }

        function stopPlaying() {
            isPlaying = false;
            playBtn.textContent = 'â–¶ PLAY';
            audio.pause();
            clearInterval(intervalId);
        }

        playBtn.addEventListener('click', () => {
            if (isPlaying) stopPlaying();
            else startPlaying();
        });

        // ğŸŒŸ ë„¤ì˜¨ ìŠ¤ìœ„ì¹˜ í´ë¦­ ì´ë²¤íŠ¸ ğŸŒŸ
        neonBtn.addEventListener('click', () => {
            isNeon = !isNeon; // ìƒíƒœë¥¼ ë°˜ëŒ€ë¡œ ë’¤ì§‘ìŠµë‹ˆë‹¤ (true <-> false)
            
            if (isNeon) {
                document.body.classList.remove('classic-mode'); // í´ë˜ì‹ ëª¨ë“œ ë„ê¸°
                neonBtn.textContent = 'NEON: ON';
            } else {
                document.body.classList.add('classic-mode'); // í´ë˜ì‹ ëª¨ë“œ ì¼œê¸°
                neonBtn.textContent = 'NEON: OFF';
            }
        });

        function updateProgress() {
            if (!audio.duration) return;
            const percent = audio.currentTime / audio.duration;
            asciiProgress.textContent = generateAsciiBar(percent, progressLen, 'progress');
            timeDisplay.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
        }

        audio.addEventListener('timeupdate', updateProgress);

        asciiProgress.addEventListener('click', (e) => {
            if (!audio.duration) return;
            const rect = asciiProgress.getBoundingClientRect();
            let percent = (e.clientX - rect.left) / rect.width;
            percent = Math.max(0, Math.min(1, percent)); 
            
            audio.currentTime = percent * audio.duration;
            renderFrame();
            updateProgress();
        });

        function updateVolume() {
            asciiVolume.textContent = generateAsciiBar(audio.volume, volumeLen, 'volume');
        }

        asciiVolume.addEventListener('click', (e) => {
            const rect = asciiVolume.getBoundingClientRect();
            let percent = (e.clientX - rect.left) / rect.width;
            percent = Math.max(0, Math.min(1, percent));
            
            audio.volume = percent;
            updateVolume();
        });

        updateVolume();

    </script>
</body>
</html>
